根据提供的源代码，系统移植的核心知识点可以总结为以下几个维度：

### 1. 设备启动流程 (Boot Flow)

嵌入式设备与 PC 的启动流程存在显著差异，主要采用分阶段启动以适配资源有限的特点：

1. **PC 启动流程**：BIOS (硬件初始化/启动方式选择) → 引导程序 (加载 OS) → 操作系统 (Windows/Linux) → 挂载文件系统 → 运行应用程序 1。

2. **嵌入式设备 (以 Exynos 4412 为例) 启动流程**：

3. **iROM (romboot)**：固化在 SoC 内部，负责基础硬件初始化及识别启动介质（SD/EMMC），将 **SPL (第二阶段程序加载器)** 读取到 iRAM 1, 2。

4. **iRAM (SPL/BL1)**：由于 iRAM 空间极小，仅执行核心初始化（时钟、DDR 内存），并将 **Bootloader 主程序 (u-boot.bin)** 搬运到 DDR 1-3。

5. **DDR 运行 Bootloader (BL2)**：初始化串口、存储设备，将操作系统加载到内存中 1, 2。

6. **系统启动**：运行 Linux 内核 → 挂载文件系统 → 运行应用程序 1, 4。

### 2. 交叉开发环境搭建

由于开发机（x86 架构）与目标机（ARM 架构）指令集不兼容，必须使用交叉开发工具：

● **交叉编译工具链**：在 PC 上编写、编译代码，生成在开发板上运行的 ARM 机器码 5-7。

● **网络服务配置**：

● **TFTP 服务器**：通过 UDP 协议快速下载内核镜像（uImage）到开发板内存，方便调试 7, 8。

● **NFS 服务器**：允许开发板通过网络挂载 PC 目录作为根文件系统，实现实时修改代码而无需重复烧录 7, 8。

● **环境变量**：PATH 用于让系统直接识别交叉编译命令；bootargs 是传递给内核的启动参数（如指定根文件系统位置）；bootcmd 是 U-Boot 自动执行的启动指令 5-7。

### 3. Linux 内核配置与编译

内核的构建涉及复杂的配置系统：

1. **核心目录结构**：arch/arm 存放架构相关代码（如设备树 dts、配置文件 configs）；drivers 存放驱动代码 7, 9。

2. **配置三要素**：

3. **Kconfig**：定义配置菜单的结构和依赖关系 10, 11。

4. **.config**：当前生效的配置蓝图，由 make defconfig 或 menuconfig 生成 10。

5. **Makefile**：根据 .config 中的宏（如 CONFIG_XXX）决定哪些文件参与编译 9, 10。

6. **镜像类型**：内核编译生成 vmlinux（ELF 格式），经压缩得到 zImage，在 zImage 前添加 64 字节头部信息后生成 U-Boot 可识别的 **uImage** 10, 12。

### 4. 根文件系统 (RootFS) 与初始化

文件系统是人机交互和统筹管理硬件软件的基础 13, 14：

● **标准目录**：/bin（存放命令）、/etc（配置文件）、/lib（**必须从交叉工具链中复制库文件**）、/dev（设备文件） 13。

● **Init 进程**：内核启动后运行的第一个程序是 /sbin/init，它根据 /etc/inittab 执行动作 13, 15。

● **关键脚本**：/etc/init.d/rcS 负责挂载文件系统、设置热插拔程序（mdev）等初始化逻辑 16。

### 5. U-Boot 移植与硬件驱动实战

移植的核心是“顺藤摸瓜”式地修改板级支持代码：

1. **U-Boot 关键文件**：u-boot.bin 是最终烧录的二进制文件；u-boot.lds 决定内存布局；u-boot.map 记录符号地址 17。

2. **调试方法**：

3. **点灯法**：在串口未就绪前，通过控制 GPIO 亮灭判断程序运行位置 18, 19。

4. **addr2line**：利用 Map 文件中的地址反查源码行号 18, 19。

5. **网卡驱动移植 (DM9000)**：

6. 在板级头文件（如 fs4412.h）中定义基地址宏（CONFIG_DM9000_BASE） 20, 21。

7. 在板级代码（origen.c）中实现 board_eth_init 函数 20, 22。

8. 屏蔽 **TZPC (安全模块)** 以免访问非安全外设时系统挂死 18, 19, 22。

9. **eMMC 驱动移植**：涉及文件迁移（s5p_mshc.c）、修改 Makefile 以支持硬件宏定义，以及修复新版 eMMC 卡的版本识别逻辑 2, 19, 23。

**比喻理解**：系统移植就像是为一个新落成的**毛坯房（硬件平台）铺设水电系统（Bootloader/内核）**。**Bootloader** 是房子的总闸，负责最初的通水通电；**内核** 是房间内的管路网络，确保每个开关（驱动）都能控制对应的电器；而**根文件系统** 则是家具和装饰，决定了住户（应用程序）如何在这个房子里生活和操作。